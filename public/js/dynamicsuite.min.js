Vue.component("ds-overlay",{template:'<div class="ds-overlay"><div class="header-column"><div :class="nav_button_classes" @click="toggleNav"><i class="fas fa-bars"></i></div></div><h1 class="title header-column">{{overlay_title}}</h1><div class="actions header-column"><component v-for="(name, key) in overlay_actions" :is="name" :key="\'action\' + key"></component></div><div v-if="show_nav" class="nav"><div class="links"><div v-for="(superlink, super_id) in overlay_nav_tree" :key="superlink.key" class="link-group"><span :class="superlinkClasses(superlink)" @click="superlinkInteraction(superlink)"><i :class="navIconClass(superlink.icon, superlink.path)"></i> <span>{{superlink.name}}</span> <span class="alerts"><span v-if="getAlert(super_id, \'failure\')" class="failure">{{getAlert(super_id, \'failure\')}}</span> <span v-if="getAlert(super_id, \'warning\')" class="warning">{{getAlert(super_id, \'warning\')}}</span> <span v-if="getAlert(super_id, \'success\')" class="success">{{getAlert(super_id, \'success\')}}</span> </span><i v-if="superlink.nav_group" :class="chevronClasses(superlink.nav_group)"></i></span><div v-if="superlink.nav_group === selected_group" class="sublinks"><span v-for="(sublink, sub_id) in superlink.views" :key="sublink.key" :class="sublinkClasses(sublink)" @click="goto(sublink.path)"><i :class="navIconClass(sublink.icon, sublink.path)"></i> <span>{{sublink.name}}</span> <span class="alerts"><span v-if="getAlert(sub_id, \'failure\')" class="failure">{{getAlert(sub_id, \'failure\')}}</span> <span v-if="getAlert(sub_id, \'warning\')" class="warning">{{getAlert(sub_id, \'warning\')}}</span> <span v-if="getAlert(sub_id, \'success\')" class="success">{{getAlert(sub_id, \'success\')}}</span></span></span></div></div></div><footer v-if="overlay_nav_footer_text" @click="goto(overlay_nav_footer_view)">{{overlay_nav_footer_text}}</footer></div></div>',props:{default_view:{type:null|String,default:null},overlay_nav_tree:{type:Array|Object,default:()=>[]},overlay_nav_footer_text:{type:null|String,default:null},overlay_nav_footer_view:{type:null|String,default:null},overlay_nav_alert_success:{type:Object|Array,default:()=>({})},overlay_nav_alert_warning:{type:Object|Array,default:()=>({})},overlay_nav_alert_failure:{type:Object|Array,default:()=>({})},overlay_title:{type:null|String,default:null},overlay_actions:{type:Array,default:()=>[]}},data:()=>({show_nav:!1,selected_group:null,pending_path:null,loading:!1}),computed:{nav_button_classes(){return{button:!0,interactive:!0,active:this.show_nav}}},methods:{goto(e){e&&(this.pending_path=e,setTimeout(()=>{this.loading=!0},100),document.location=e)},toggleNav(){this.pending_path||(this.show_actions=!1,this.show_nav=!this.show_nav)},chevronClasses(e){return{fas:!0,"fa-chevron-right":e!==this.selected_group,"fa-chevron-down":e===this.selected_group}},superlinkClasses(e){return{superlink:!0,active:e.active,selected:null!==e.nav_group&&this.selected_group===e.nav_group}},superlinkInteraction(e){e.hasOwnProperty("path")?this.goto(e.path):this.selected_group===e.nav_group?this.selected_group=null:this.selected_group=e.nav_group},sublinkClasses:e=>({sublink:!0,active:e.active}),navIconClass(e,s){return this.loading&&s===this.pending_path?"fas fa-circle-notch fa-spin":e},getAlert(e,s){const t=`overlay_nav_alert_${s}`;return!("object"!=typeof this[t]||!this[t].hasOwnProperty(e))&&this[t][e]},setNavActive(e=null){let s;s=e?e.split("?")[0].split("#")[0]:window.location.pathname.split("?")[0].split("#")[0],this.active_view=s;const t="/"===s?this.default_view:s;e&&history.pushState({},"",e),this.selected_group=null;for(const e in this.overlay_nav_tree)if(this.overlay_nav_tree[e].hasOwnProperty("path")&&this.overlay_nav_tree[e].path.startsWith("/"))this.$root.overlay_nav_tree[e].active=this.overlay_nav_tree[e].path===t;else for(const s in this.overlay_nav_tree[e].views){const a=this.overlay_nav_tree[e].views[s].path===t;this.$root.overlay_nav_tree[e].active=a,this.$root.overlay_nav_tree[e].views[s].active=a,a&&(this.selected_group=this.overlay_nav_tree[e].nav_group)}}},mounted(){this.setNavActive(),document.getElementById("ds-content").addEventListener("click",()=>{this.pending_path||(this.show_nav=!1,this.show_actions=!1)})}});
class DynamicSuite{static call(e,t,a){fetch(`/dynamicsuite/api/${e}`,{method:"POST",body:JSON.stringify(t||[])}).then(e=>{if(e.ok)return e;throw new Error("A server error has occurred")}).then(e=>e.json()).then(e=>a(e),()=>a({status:"SERVER_ERROR",message:"A malformed response was returned",data:null})).catch(e=>{console.log(e),a({status:"SERVER_ERROR",message:"A malformed response was returned",data:null})})}static readCustomData(e){return!(!window.dynamicsuite.hasOwnProperty("custom")||!window.dynamicsuite.custom.hasOwnProperty(e))&&window.dynamicsuite.custom[e]}}window.addEventListener("load",()=>{DynamicSuite.vm=new Vue({name:"DynamicSuite",el:"#dynamicsuite",data:()=>({selected_group:null,has_session:!1,hide_overlay:!0,default_view:null,overlay_nav_tree:[],overlay_nav_footer_text:null,overlay_nav_footer_view:null,overlay_nav_alert_success:{},overlay_nav_alert_warning:{},overlay_nav_alert_failure:{},overlay_title:null,overlay_actions:[]}),methods:{setNavAlert(e,t,a){const s=`overlay_nav_alert_${e}`;this.$set(this[s],t,a)},setNavActive(e){this.$refs.ds_overlay.setNavActive(e)}},mounted(){for(const e of Object.keys(this._data))window.dynamicsuite.hasOwnProperty(e)&&(this[e]=window.dynamicsuite[e]);document.getElementById("dynamicsuite").style.display="flex",location.hash&&(location.href=location.hash)}})});