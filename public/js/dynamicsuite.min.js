Vue.component("ds-overlay",{template:`<div class="ds-overlay"><div class="header-column"><div :class="nav_button_classes" @click="toggleNav"><i class="fas fa-bars"></i></div></div><h1 class="title header-column">{{overlay_title}}</h1><div class="actions header-column"><component v-for="(name, key) in overlay_actions" :is="name" :key="'action' + key"></component></div><div v-if="show_nav" class="nav"><div class="links"><div v-for="(superlink, super_id) in overlay_nav_tree" :key="superlink.key" class="link-group"><span :class="superlinkClasses(superlink)" @click="superlinkInteraction(superlink)"><i :class="navIconClass(superlink.icon, superlink.path)"></i> <span>{{superlink.name}}</span> <span class="alerts"><span v-if="getAlert(super_id, 'failure')" class="failure">{{getAlert(super_id, 'failure')}}</span> <span v-if="getAlert(super_id, 'warning')" class="warning">{{getAlert(super_id, 'warning')}}</span> <span v-if="getAlert(super_id, 'success')" class="success">{{getAlert(super_id, 'success')}}</span> </span><i v-if="superlink.nav_group" :class="chevronClasses(superlink.nav_group)"></i></span><div v-if="superlink.nav_group === selected_group" class="sublinks"><span v-for="(sublink, sub_id) in superlink.views" :key="sublink.key" :class="sublinkClasses(sublink)" @click="goto(sublink.path)"><i :class="navIconClass(sublink.icon, sublink.path)"></i> <span>{{sublink.name}}</span> <span class="alerts"><span v-if="getAlert(sub_id, 'failure')" class="failure">{{getAlert(sub_id, 'failure')}}</span> <span v-if="getAlert(sub_id, 'warning')" class="warning">{{getAlert(sub_id, 'warning')}}</span> <span v-if="getAlert(sub_id, 'success')" class="success">{{getAlert(sub_id, 'success')}}</span></span></span></div></div></div><footer v-if="overlay_nav_footer_text" @click="goto(overlay_nav_footer_view)">{{overlay_nav_footer_text}}</footer></div></div>`,props:{default_view:{type:null|String,default:null},overlay_nav_tree:{type:Array|Object,default:()=>[]},overlay_nav_footer_text:{type:null|String,default:null},overlay_nav_footer_view:{type:null|String,default:null},overlay_nav_alert_success:{type:Object|Array,default:()=>({})},overlay_nav_alert_warning:{type:Object|Array,default:()=>({})},overlay_nav_alert_failure:{type:Object|Array,default:()=>({})},overlay_title:{type:null|String,default:null},overlay_actions:{type:Array,default:()=>[]}},data(){return{show_nav:!1,selected_group:null,pending_path:null,loading:!1}},computed:{nav_button_classes(){return{button:!0,interactive:!0,active:this.show_nav}}},methods:{goto(e){e&&(this.pending_path=e,setTimeout(()=>{this.loading=!0},100),document.location=e)},toggleNav(){this.pending_path||(this.show_actions=!1,this.show_nav=!this.show_nav)},chevronClasses(e){return{fas:!0,"fa-chevron-right":e!==this.selected_group,"fa-chevron-down":e===this.selected_group}},superlinkClasses(e){return{superlink:!0,active:e.active,selected:null!==e.nav_group&&this.selected_group===e.nav_group}},superlinkInteraction(e){e.hasOwnProperty("path")?this.goto(e.path):this.selected_group===e.nav_group?this.selected_group=null:this.selected_group=e.nav_group},sublinkClasses(e){return{sublink:!0,active:e.active}},navIconClass(e,s){return this.loading&&s===this.pending_path?"fas fa-circle-notch fa-spin":e},getAlert(e,s){s=`overlay_nav_alert_${s}`;return!("object"!=typeof this[s]||!this[s].hasOwnProperty(e))&&this[s][e]},setNavActive(e=null){let s;s=(e||window.location.pathname).split("?")[0].split("#")[0],this.active_view=s;var t="/"===s?this.default_view:s;e&&history.pushState({},"",e),this.selected_group=null;for(const n in this.overlay_nav_tree)if(this.overlay_nav_tree[n].hasOwnProperty("path")&&this.overlay_nav_tree[n].path.startsWith("/"))this.$root.overlay_nav_tree[n].active=this.overlay_nav_tree[n].path===t;else for(const i in this.overlay_nav_tree[n].views){var a=this.overlay_nav_tree[n].views[i].path===t;this.$root.overlay_nav_tree[n].active=a,(this.$root.overlay_nav_tree[n].views[i].active=a)&&(this.selected_group=this.overlay_nav_tree[n].nav_group)}}},mounted(){this.setNavActive(),document.getElementById("ds-content").addEventListener("click",()=>{this.pending_path||(this.show_nav=!1,this.show_actions=!1)})}});
class DynamicSuite{static call(t,e,a){fetch(`/dynamicsuite/api/${t}`,{method:"POST",body:JSON.stringify(e||[])}).then(t=>{if(t.ok)return t;throw new Error("A server error has occurred")}).then(t=>t.json()).then(t=>a(t),()=>a({status:"SERVER_ERROR",message:"A malformed response was returned",data:null})).catch(t=>{console.log(t),a({status:"SERVER_ERROR",message:"A malformed response was returned",data:null})})}static readCustomData(t){return void 0!==window.dynamicsuite.custom[t]&&window.dynamicsuite.custom[t]}static broadcast(t,e){void 0!==this.vm&&this.vm.$emit(t,e)}static listen(t,e){void 0!==this.vm&&this.vm.$on(t,e)}static readURLParam(t){const e=new URLSearchParams(window.location.search);return e.get(t)}static updateURL(t,e){const a=new URLSearchParams(window.location.search);null===e?a.delete(t):a.set(t,e);e=a.toString();return e?`${window.location.pathname}?${e}`:window.location.pathname}static pushURLHistory(t,e){history.pushState({},null,DynamicSuite.updateURL(t,e))}static replaceURLHistory(t,e){history.replaceState({},null,DynamicSuite.updateURL(t,e))}}window.addEventListener("load",()=>{DynamicSuite.vm=new Vue({name:"DynamicSuite",el:"#dynamicsuite",data(){return{selected_group:null,has_session:!1,hide_overlay:!0,default_view:null,overlay_nav_tree:[],overlay_nav_footer_text:null,overlay_nav_footer_view:null,overlay_nav_alert_success:{},overlay_nav_alert_warning:{},overlay_nav_alert_failure:{},overlay_title:null,overlay_actions:[]}},methods:{setNavAlert(t,e,a){this.$set(this[`overlay_nav_alert_${t}`],e,a)},setNavActive(t){this.$refs.ds_overlay.setNavActive(t)}},mounted(){for(const t of Object.keys(this._data))window.dynamicsuite.hasOwnProperty(t)&&(this[t]=window.dynamicsuite[t]);document.getElementById("dynamicsuite").style.display="flex",location.hash&&(location.href=location.hash),document.dispatchEvent(new CustomEvent("dynamicsuite-init",{detail:{vm:this}}))}})});